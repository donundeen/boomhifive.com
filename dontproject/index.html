<html>
<head>
    <title>Don't Project, Projector Project</title>
</head>
<body>
    <h1>Project! v.3</h1>
    <iframe
    src="https://player.twitch.tv/?channel=dontproject&parent=undeen.com"
    height="480"
    width="720"
    allowfullscreen>
</iframe>
<button onclick="sendFwd();">&lt;&lt;BACK&lt;&lt;</button>
|||
<button onclick="sendRev();">&gt;&gt;FORWARD&gt;&gt;</button>

<script>

// chnage this depending on location of webserver. Figure out a way to make this more dynamic...
let host =  window.location.host;
host = host.replace(/:[0-9]+/,"");
// remove port
console.log(host);
const ws = new WebSocket('ws://'+host+':8080');


let wsready = false;  
// Browser WebSockets have slightly different syntax than `ws`.
// Instead of EventEmitter syntax `on('open')`, you assign a callback
// to the `onopen` property.
ws.onopen = function() {
    wsready = true;
};

ws.onerror = function(msg){
    console.log("ws error ");
    console.log(msg);
}

ws.onmessage = function(msg) {
    console.log("got message "+ msg);
    console.log(JSON.stringify(msg));
};  

function sendFwd(){
    sendMessage("fwd");
}
function sendRev(){
    sendMessage("rev");
}
function sendMessage(message){
    if(wsready){
        ws.send(message);
    }else{
        console.log("ws not ready");
    }
}


</script>

</body>

</html>